# å¯»æ‰¾ä¸¤ä¸ªæ­£åºæ•°ç»„çš„ä¸­ä½æ•°

ç»™å®šä¸¤ä¸ªå¤§å°åˆ†åˆ«ä¸º `m` å’Œ `n` çš„æ­£åºï¼ˆä»å°åˆ°å¤§ï¼‰æ•°ç»„ `nums1` å’Œ `nums2`ã€‚è¯·ä½ æ‰¾å‡ºå¹¶è¿”å›è¿™ä¸¤ä¸ªæ­£åºæ•°ç»„çš„ **ä¸­ä½æ•°** ã€‚

ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦åº”è¯¥ä¸º `O(log (m+n))` ã€‚

 

**ç¤ºä¾‹ 1ï¼š**

```
è¾“å…¥ï¼šnums1 = [1,3], nums2 = [2]
è¾“å‡ºï¼š2.00000
è§£é‡Šï¼šåˆå¹¶æ•°ç»„ = [1,2,3] ï¼Œä¸­ä½æ•° 2
```

**ç¤ºä¾‹ 2ï¼š**

```
è¾“å…¥ï¼šnums1 = [1,2], nums2 = [3,4]
è¾“å‡ºï¼š2.50000
è§£é‡Šï¼šåˆå¹¶æ•°ç»„ = [1,2,3,4] ï¼Œä¸­ä½æ•° (2 + 3) / 2 = 2.5
```

 

 

**æç¤ºï¼š**

- `nums1.length == m`
- `nums2.length == n`
- `0 <= m <= 1000`
- `0 <= n <= 1000`
- `1 <= m + n <= 2000`
- `-106 <= nums1[i], nums2[i] <= 106`

## è§£å†³æ–¹æ¡ˆ

```cpp
class Solution {
public:
    double findMedianSortedArrays(vector<int>& nums1, vector<int>& nums2) {
        // ç¡®ä¿nums1æ˜¯è¾ƒçŸ­æ•°ç»„ï¼Œä¿è¯è¿­ä»£æ¬¡æ•°å°‘
        if(nums1.size() > nums2.size())
            return findMedianSortedArrays(nums2, nums1);
        // å¼€å§‹å¤„ç†
        int m = nums1.size(), n = nums2.size();
        // å°†è¯¥é—®é¢˜ä¸­éœ€è¦æŸ¥æ‰¾çš„å†…å®¹æ”¹ä¸ºnums1åœ¨ä¸­ä½æ•°å·¦è¾¹è¯¥æœ‰å¤šå°‘ä¸ªå…ƒç´ 
        int left = 0, right = m; // æœç´¢nums1ä¸­å·¦åŠéƒ¨åˆ†å…ƒç´ è¯¥æœ‰å¤šå°‘ä¸ªçš„èŒƒå›´
        int left_size = (m+n+1)/2; // å·¦åŠéƒ¨åˆ†çš„å…ƒç´ ä¸ªæ•°
        // äºŒåˆ†æŸ¥æ‰¾ï¼Œå·¦å³éƒ½æ˜¯é—­åŒºé—´
        while(left <= right){
            // nums1ä¸­å·¦åŠéƒ¨åˆ†å…ƒç´ ä¸ªæ•°
            int i = (left+right)/2;
            // nums2ä¸­çš„å·¦åŠéƒ¨åˆ†å…ƒç´ ä¸ªæ•°
            int j = left_size-i;
            
            // è®¡ç®—äºŒåˆ†æŸ¥æ‰¾çš„åˆ¤æ–­ä¾æ®
            // nums1å·¦åŠéƒ¨åˆ†çš„æœ€å¤§å€¼
            int nums1_left_max = (i==0) ? INT_MIN : nums1[i-1];
            // nums1å³åŠéƒ¨åˆ†çš„æœ€å°å€¼
            int nums1_right_min = (i==m) ? INT_MAX : nums1[i];
            // nums2å·¦åŠéƒ¨åˆ†çš„æœ€å¤§å€¼
            int nums2_left_max = (j==0) ? INT_MIN : nums2[j-1];
            // nums2å³åŠéƒ¨åˆ†çš„æœ€å°å€¼
            int nums2_right_min = (j==n) ? INT_MAX : nums2[j];
            
            // æ£€æŸ¥åˆ†å‰²çš„æ­£ç¡®æ€§
            if(nums1_left_max <= nums2_right_min && nums2_left_max <= nums1_right_min){
                // åˆ†å‰²æ­£ç¡®
                if((m+n)%2)
                    // å¥‡æ•°ä¸ªå…ƒç´ ï¼Œä¸­ä½æ•°æ˜¯å·¦åŠéƒ¨åˆ†çš„æœ€å¤§å€¼
                    return max(nums1_left_max, nums2_left_max);
                else
                    // å¶æ•°ä¸ªå…ƒç´ ï¼Œä¸­ä½æ•°æ˜¯å·¦åŠéƒ¨åˆ†æœ€å¤§å€¼å’Œå³åŠéƒ¨åˆ†æœ€å°å€¼çš„å¹³å‡å€¼
                    return (max(nums1_left_max, nums2_left_max)+min(nums1_right_min, nums2_right_min))/2.0;
            }
            else if (nums1_left_max > nums2_right_min)
                // nums1å·¦åŠéƒ¨åˆ†å¤ªå¤š
                right = i-1;
            else
                // nums1å·¦åŠéƒ¨åˆ†å¤ªå°‘
                left = i+1;
        }
        return 0.0;
    }
};
```

## ç®—æ³•æ€è·¯

1. **é—®é¢˜è½¬åŒ–**ï¼š
   - å¯»æ‰¾ä¸­ä½æ•°ç­‰ä»·äºæ‰¾åˆ°æ­£ç¡®çš„åˆ†å‰²ç‚¹
   - å°†ä¸¤ä¸ªæ•°ç»„åˆ†æˆå·¦å³ä¸¤éƒ¨åˆ†ï¼Œä½¿å¾—å·¦åŠéƒ¨åˆ†çš„æ‰€æœ‰å…ƒç´ éƒ½å°äºå³åŠéƒ¨åˆ†

2. **åˆ†å‰²æ¡ä»¶**ï¼š
   - å·¦åŠéƒ¨åˆ†åŒ…å« `(m + n + 1) / 2` ä¸ªå…ƒç´ 
   - å·¦åŠéƒ¨åˆ†çš„æœ€å¤§å€¼ â‰¤ å³åŠéƒ¨åˆ†çš„æœ€å°å€¼

3. **äºŒåˆ†æŸ¥æ‰¾**ï¼š
   - åœ¨è¾ƒçŸ­çš„æ•°ç»„ä¸Šè¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾
   - ç¡®å®šè¯¥æ•°ç»„ä¸­å·¦åŠéƒ¨åˆ†çš„å…ƒç´ ä¸ªæ•°
   - æ ¹æ®åˆ†å‰²æ¡ä»¶è°ƒæ•´æœç´¢èŒƒå›´

## å…³é”®å˜é‡è¯´æ˜

- `i`ï¼šnums1 ä¸­å·¦åŠéƒ¨åˆ†çš„å…ƒç´ ä¸ªæ•°
- `j`ï¼šnums2 ä¸­å·¦åŠéƒ¨åˆ†çš„å…ƒç´ ä¸ªæ•°
- `totalLeft`ï¼šå·¦åŠéƒ¨åˆ†åº”è¯¥æœ‰çš„æ€»å…ƒç´ ä¸ªæ•°
- `nums1LeftMax`ï¼šnums1 å·¦åŠéƒ¨åˆ†çš„æœ€å¤§å€¼
- `nums1RightMin`ï¼šnums1 å³åŠéƒ¨åˆ†çš„æœ€å°å€¼
- `nums2LeftMax`ï¼šnums2 å·¦åŠéƒ¨åˆ†çš„æœ€å¤§å€¼
- `nums2RightMin`ï¼šnums2 å³åŠéƒ¨åˆ†çš„æœ€å°å€¼

## åˆ†å‰²æ¡ä»¶æ£€æŸ¥

```cpp
if (nums1LeftMax <= nums2RightMin && nums2LeftMax <= nums1RightMin) {
    // åˆ†å‰²æ­£ç¡®
}
```

è¿™ä¸ªæ¡ä»¶ç¡®ä¿ï¼š
1. nums1 å·¦åŠéƒ¨åˆ†çš„æœ€å¤§å€¼ â‰¤ nums2 å³åŠéƒ¨åˆ†çš„æœ€å°å€¼
2. nums2 å·¦åŠéƒ¨åˆ†çš„æœ€å¤§å€¼ â‰¤ nums1 å³åŠéƒ¨åˆ†çš„æœ€å°å€¼

## ç¤ºä¾‹åˆ†æ

å¯¹äº `nums1 = [1,3], nums2 = [2]`ï¼š

1. ç¡®ä¿ nums1 æ˜¯è¾ƒçŸ­çš„æ•°ç»„
2. `totalLeft = (2 + 1 + 1) / 2 = 2`
3. äºŒåˆ†æŸ¥æ‰¾ç¡®å®š nums1 ä¸­å·¦åŠéƒ¨åˆ†çš„å…ƒç´ ä¸ªæ•°
4. æ‰¾åˆ°æ­£ç¡®çš„åˆ†å‰²ç‚¹åè®¡ç®—ä¸­ä½æ•°

## æ—¶é—´å¤æ‚åº¦

- æ—¶é—´å¤æ‚åº¦ï¼šO(log(min(m, n)))
- ç©ºé—´å¤æ‚åº¦ï¼šO(1)

## **ğŸ¤”ä¸ºä½•è¦ç¡®ä¿ `nums1` æ˜¯è¾ƒçŸ­çš„æ•°ç»„æœ‰å‡ ä¸ªé‡è¦åŸå› ï¼š**

### 1. æ—¶é—´å¤æ‚åº¦ä¼˜åŒ–

#### äºŒåˆ†æŸ¥æ‰¾çš„å¤æ‚åº¦
- å¦‚æœæˆ‘ä»¬åœ¨è¾ƒçŸ­çš„æ•°ç»„ä¸Šè¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯ `O(log(min(m, n)))`
- å¦‚æœæˆ‘ä»¬åœ¨è¾ƒé•¿çš„æ•°ç»„ä¸Šè¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯ `O(log(max(m, n)))`

#### å…·ä½“ä¾‹å­
å‡è®¾ `nums1` é•¿åº¦ä¸º 1000ï¼Œ`nums2` é•¿åº¦ä¸º 100ï¼š
- åœ¨ `nums1` ä¸ŠäºŒåˆ†æŸ¥æ‰¾ï¼š`log(1000) â‰ˆ 10` æ¬¡è¿­ä»£
- åœ¨ `nums2` ä¸ŠäºŒåˆ†æŸ¥æ‰¾ï¼š`log(100) â‰ˆ 7` æ¬¡è¿­ä»£

é€‰æ‹©è¾ƒçŸ­çš„æ•°ç»„å¯ä»¥æ˜¾è‘—å‡å°‘è¿­ä»£æ¬¡æ•°ï¼

### 2. è¾¹ç•Œæƒ…å†µå¤„ç†ç®€åŒ–

#### å½“ `j` å¯èƒ½ä¸ºè´Ÿæ•°æ—¶
```cpp
int j = totalLeft - i;
```

å¦‚æœ `nums1` è¾ƒé•¿ï¼Œ`i` å¯èƒ½å¾ˆå¤§ï¼Œå¯¼è‡´ `j` ä¸ºè´Ÿæ•°ï¼Œè¿™ä¼šå¯¼è‡´æ•°ç»„è¶Šç•Œã€‚

#### ä¾‹å­è¯´æ˜
å‡è®¾ `nums1 = [1,2,3,4,5]`ï¼Œ`nums2 = [6]`ï¼š
- `totalLeft = (5 + 1 + 1) / 2 = 3`
- å¦‚æœ `i = 4`ï¼Œé‚£ä¹ˆ `j = 3 - 4 = -1`
- è®¿é—® `nums2[-1]` ä¼šå¯¼è‡´è¶Šç•Œ

ä½†å¦‚æœ `nums1` æ˜¯è¾ƒçŸ­çš„æ•°ç»„ï¼Œ`i` ä¸ä¼šè¶…è¿‡ `nums1` çš„é•¿åº¦ï¼Œ`j` ä¸ä¼šä¸ºè´Ÿæ•°ã€‚

### 3. ç®—æ³•é€»è¾‘çš„ä¸€è‡´æ€§

#### åˆ†å‰²ç‚¹çš„å«ä¹‰
- `i` è¡¨ç¤º `nums1` ä¸­å·¦åŠéƒ¨åˆ†çš„å…ƒç´ ä¸ªæ•°
- `j` è¡¨ç¤º `nums2` ä¸­å·¦åŠéƒ¨åˆ†çš„å…ƒç´ ä¸ªæ•°

å½“ `nums1` è¾ƒçŸ­æ—¶ï¼Œ`i` çš„èŒƒå›´æ˜¯ `[0, m]`ï¼Œè¿™æ›´ç¬¦åˆç›´è§‰ã€‚

### 4. å…·ä½“ä¾‹å­éªŒè¯

#### ä¾‹å­1ï¼šnums1è¾ƒçŸ­
```
nums1 = [1, 3], nums2 = [2, 4, 5, 6]
totalLeft = (2 + 4 + 1) / 2 = 3
i çš„èŒƒå›´ï¼š[0, 2]
j çš„èŒƒå›´ï¼š[1, 3] (å› ä¸º j = totalLeft - i)
```

#### ä¾‹å­2ï¼šnums1è¾ƒé•¿ï¼ˆä¸æ¨èï¼‰
```
nums1 = [1, 2, 3, 4, 5], nums2 = [6]
totalLeft = (5 + 1 + 1) / 2 = 3
i çš„èŒƒå›´ï¼š[0, 5]
j çš„èŒƒå›´ï¼š[-2, 3] (å¯èƒ½ä¸ºè´Ÿæ•°ï¼)
```

## è¾¹ç•Œæƒ…å†µå¤„ç†

1. **ç©ºæ•°ç»„**ï¼šé€šè¿‡ INT_MIN å’Œ INT_MAX å¤„ç†
2. **å•å…ƒç´ æ•°ç»„**ï¼šç®—æ³•ä»ç„¶æœ‰æ•ˆ
3. **æ‰€æœ‰å…ƒç´ ç›¸ç­‰**ï¼šç®—æ³•ä»ç„¶æœ‰æ•ˆ

## ä½ çš„ä»£ç é—®é¢˜åˆ†æ

```cpp
// ä½ çš„ä»£ç é—®é¢˜
class Solution {
public:
    double findMedianSortedArrays(vector<int>& nums1, vector<int>& nums2) {
        // ç¡®ä¿nums1æ˜¯è¾ƒçŸ­æ•°ç»„ï¼Œä¿è¯è¿­ä»£æ¬¡æ•°å°‘
        if(nums1.size() > nums2.size())
            return findMedianSortedArrays(nums2, nums1);
        // å¼€å§‹å¤„ç†
        int m = nums1.size(), n = nums2.size();
        int left = 0, right = m;
        int left_size = (m+n+1)/2; // å·¦åŠéƒ¨åˆ†çš„å…ƒç´ ä¸ªæ•°
        // äºŒåˆ†æŸ¥æ‰¾ï¼Œå·¦å³éƒ½æ˜¯é—­åŒºé—´
        while(left <= right){
            // nums1ä¸­å·¦åŠéƒ¨åˆ†å…ƒç´ ä¸ªæ•°
            int i = (left+right)/2;
            // nums2ä¸­çš„å·¦åŠéƒ¨åˆ†å…ƒç´ ä¸ªæ•°
            int j = left_size-i;
            
            // è®¡ç®—äºŒåˆ†æŸ¥æ‰¾çš„åˆ¤æ–­ä¾æ®
            // nums1å·¦åŠéƒ¨åˆ†çš„æœ€å¤§å€¼
            int nums1_left_max = (i==0) ? INT_MIN : nums1[i-1];
            // nums1å³åŠéƒ¨åˆ†çš„æœ€å°å€¼
            int nums1_right_min = (i==m) ? INT_MAX : nums1[i];
            // nums2å·¦åŠéƒ¨åˆ†çš„æœ€å¤§å€¼
            int nums2_left_max = (j==0) ? INT_MIN : nums2[j-1];
            // nums2å³åŠéƒ¨åˆ†çš„æœ€å°å€¼
            int nums2_right_min = (j==n) ? INT_MAX : nums2[j];
            
            // æ£€æŸ¥åˆ†å‰²çš„æ­£ç¡®æ€§
            if(nums1_left_max <= nums2_right_min && nums2_left_max <= nums1_right_min){
                // åˆ†å‰²æ­£ç¡®
                if((m+n)%2)
                    // å¥‡æ•°ä¸ªå…ƒç´ ï¼Œä¸­ä½æ•°æ˜¯å·¦åŠéƒ¨åˆ†çš„æœ€å¤§å€¼
                    return max(nums1_left_max, nums2_left_max);
                else
                    // å¶æ•°ä¸ªå…ƒç´ ï¼Œä¸­ä½æ•°æ˜¯å·¦åŠéƒ¨åˆ†æœ€å¤§å€¼å’Œå³åŠéƒ¨åˆ†æœ€å°å€¼çš„å¹³å‡å€¼
                    return (max(nums1_left_max, nums2_left_max)+min(nums1_right_min, nums2_right_min))/2;  // é—®é¢˜1ï¼šæ•´æ•°é™¤æ³•
            }
            else if (nums1_left_max > nums2_right_min)
                // nums1å·¦åŠéƒ¨åˆ†å¤ªå¤š
                right = i-1;
            else
                // nums1å·¦åŠéƒ¨åˆ†å¤ªå°‘
                left = i+1;
        }
        return 0.0;
    }
};
```
